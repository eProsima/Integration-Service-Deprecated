<?xml version="1.0"?>
<is>
    <topic_types>
        <type name="HelloWorld">
            <library>build/libkeyhelloworld_dyn_dyn_lib.so</library>
        </type>
    </topic_types>

    <types>
        <!--
        struct sample{
            octet index;
            @Key octet key_value;
        };
        -->
        <type>
            <struct name="sample">
                <octet name="index"/>
                <octet name="key_value" key="true"/>
            </struct>
        </type>
    </types>

    <profiles>
        <participant profile_name="HelloWorldParticipant">
            <rtps>
                <builtin>
                    <domainId>0</domainId>
                    <leaseDuration>
                        <durationbyname>INFINITE</durationbyname>
                    </leaseDuration>
                </builtin>
            </rtps>

            <subscriber profile_name="subHW">
                <topic>
                    <name>HelloWorldTopic</name>
                    <dataType>HelloWorld</dataType>
                </topic>
                <qos>
                    <reliability>
                        <kind>RELIABLE</kind>
                    </reliability>
                    <liveliness>
                        <kind>AUTOMATIC</kind>
                        <lease_duration>INFINITE</lease_duration>
                    </liveliness>
                    <durability>
                        <kind>TRANSIENT_LOCAL</kind>
                    </durability>
                </qos>
                <historyMemoryPolicy>DYNAMIC</historyMemoryPolicy>
            </subscriber>

            <publisher profile_name="pubHW">
                <topic>
                    <name>HelloWorldTopic</name>
                    <dataType>HelloWorld</dataType>
                </topic>
                <qos>
                    <reliability>
                        <kind>RELIABLE</kind>
                    </reliability>
                    <liveliness>
                        <kind>AUTOMATIC</kind>
                        <lease_duration>INFINITE</lease_duration>
                    </liveliness>
                    <durability>
                        <kind>TRANSIENT_LOCAL</kind>
                    </durability>
                </qos>
                <historyMemoryPolicy>DYNAMIC</historyMemoryPolicy>
            </publisher>

        </participant>

        <participant profile_name="KeysParticipant">
            <rtps>
                <builtin>
                    <domainId>0</domainId>
                    <leaseDuration>
                        <durationbyname>INFINITE</durationbyname>
                    </leaseDuration>
                </builtin>
            </rtps>

            <subscriber profile_name="subK">
                <topic>
                    <name>samplePubSubTopic</name>
                    <dataType>sample</dataType>
                    <kind>WITH_KEY</kind>
                    <historyQos>
                        <kind>KEEP_ALL</kind>
                    </historyQos>
                    <resourceLimitsQos>
                        <max_samples>100</max_samples>
                        <allocated_samples>100</allocated_samples>
                        <max_instances>5</max_instances>
                        <max_samples_per_instance>20</max_samples_per_instance>
                    </resourceLimitsQos>
                </topic>
                <qos>
                    <reliability>
                        <kind>RELIABLE</kind>
                    </reliability>
                    <durability>
                        <kind>VOLATILE</kind>
                    </durability>
                </qos>
                <historyMemoryPolicy>DYNAMIC</historyMemoryPolicy>
            </subscriber>

            <publisher profile_name="pubK">
                <topic>
                    <name>samplePubSubTopic</name>
                    <dataType>sample</dataType>
                    <kind>WITH_KEY</kind>
                    <historyQos>
                        <kind>KEEP_ALL</kind>
                    </historyQos>
                    <resourceLimitsQos>
                        <max_samples>100</max_samples>
                        <allocated_samples>100</allocated_samples>
                        <max_instances>5</max_instances>
                        <max_samples_per_instance>20</max_samples_per_instance>
                    </resourceLimitsQos>
                </topic>
                <qos>
                    <reliability>
                        <kind>RELIABLE</kind>
                    </reliability>
                    <durability>
                        <kind>VOLATILE</kind>
                    </durability>
                </qos>
                <historyMemoryPolicy>DYNAMIC</historyMemoryPolicy>
            </publisher>
        </participant>
    </profiles>

    <connector name="HW_to_Key">
        <subscriber participant_name="HelloWorldParticipant" subscriber_name="subHW"/>
        <publisher participant_name="KeysParticipant" publisher_name="pubK"/>
        <transformation file="build/libkeyhelloworld_dyn_dyn_lib.so" function="HelloWorldToKey"/>
    </connector>
<!--
    <connector name="Key_to_HW">
        <subscriber participant_name="KeysParticipant" subscriber_name="subK"/>
        <publisher participant_name="HelloWorldParticipant" publisher_name="pubHW"/>
    <transformation file="build/libkeyhelloworld_dyn_dyn_lib.so" function="KeyToHelloWorld"/>
    </connector>
-->
</is>
